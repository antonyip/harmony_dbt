version: 2

sources:
  - name: chainwalkers
    schema: prod
    database: chainwalkers
    freshness: # default freshness
      warn_after: {count: 24, period: hour}
      error_after: {count: 48, period: hour}
    loaded_at_field: ingested_at

    tables:
      - name: harmony_blocks
        description: "Blocks from the Harmony chain. Note always use the latest ingested at timestamp as duplicates can exist in this table!"
        columns:
          - name: record_id
            description: A unique id for the record generated by Chainwalkers.
          - name: offset_id
            description: Synonmous with `block_id` for Harmony.
          - name: block_id
            description: The height of the chain this block corresponds with.
          - name: block_timestamp
            description: The time the block was minted.
          - name: network
            description: The blockchain network. (i.e. mainnet, testnet, etc.)
          - name: chain_id
            description: Synonmous with blockchain name for Harmony.
          - name: tx_count
            description: The number of transactions in the block.
          - name: header
            description: A json column containing the block's header information.
          - name: ingested_at
            description: The time this row was ingested by Chainwalkers.
      - name: harmony_txs
        description: "Txs from the Harmony chain. Note always use the latest ingested at timestamp as duplicates can exist in this table!"
        columns:
          - name: record_id
            description: A unique id for the record generated by Chainwalkers.
          - name: tx_id
            description: Synonmous with transaction hash, a unique on chain identifier for the transaction.
          - name: tx_block_index
            description: The index of the transaction within the block. Starts at 0.
          - name: offset_id
            description: Synonmous with `block_id` for Harmony.
          - name: block_id
            description: The height of the chain this block corresponds with.
          - name: block_timestamp
            description: The time the block was minted.
          - name: network
            description: The blockchain network. (i.e. mainnet, testnet, etc.)
          - name: chain_id
            description: Synonmous with blockchain name for Harmony.
          - name: ingested_at
            description: The time this row was ingested by Chainwalkers.

  - name: harmony
    schema: prod
    database: harmony
    freshness: # default freshness
      warn_after: {count: 24, period: hour}
      error_after: {count: 48, period: hour}
      filter: datediff('hour', block_timestamp, current_timestamp) < 48
    loaded_at_field: ingested_at

    tables:
      - name: blocks
      - name: btc_bridge
      - name: dfk_bank_transactions
      - name: dfk_hero_rental
      - name: dfk_hero_summons
      - name: dfk_hero_updates
      - name: dfk_item_transactions
      - name: dfk_potions_crafted
      - name: dfk_quest_rewards
      - name: dfk_seed_harvests
      - name: dfk_seed_liquidity_actions
      - name: logs
      - name: swaps
      - name: transfers
      - name: txs


  - name: ingest
    schema: public
    database: ingest
    tables:
      - name: src_old_ant_ingest
        description: "Ingest from ant - when it was directly ingested into the harmony db"
        columns:
          - name: ingest_timestamp
            description: What time this infomations was ingested
          - name: ingest_data
            description: the json that was ingested
      - name: src_old_tokenprice_coingecko_mr
        description: "Token Prices in Harmony Chain from CoinGecko - when it was directly ingested into the harmony db"
        columns:
          - name: address
            description: token_address.
          - name: usd
            description: USD Price.
          - name: usd_24h_change
            description: USD Price Changed in the last 24 Hours
          - name: usd_24h_vol
            description: 24 Hour Volume Traded.
          - name: usd_market_cap
            description: Market Cap of the coin in USD.
          - name: timestamp
            description: When the data was ingested.
      - name: ant_ingest
        description: "Ingest from ant"
        columns:
          - name: ingest_timestamp
            description: What time this infomations was ingested
          - name: ingest_data
            description: The json that was ingested.
      - name: src_token_usd_prices
        description: "Token Prices in Harmony Chain from CoinGecko"
        columns:
          - name: address
            description: token_address.
          - name: usd
            description: USD Price.
          - name: usd_24h_change
            description: USD Price Changed in the last 24 Hours
          - name: usd_24h_vol
            description: 24 Hour Volume Traded.
          - name: usd_market_cap
            description: Market Cap of the coin in USD.
          - name: timestamp
            description: When the data was ingested.
